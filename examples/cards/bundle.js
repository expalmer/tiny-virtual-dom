(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports = {
	ADD_CARD: 'ADD_CARD',
	ADD_TASK: 'ADD_TASK',
	TASK_TOGGLE: 'TASK_TOGGLE',
	REMOVE_TASK: 'REMOVE_TASK',
	COUNTING: 'COUNTING',
	STOP: 'STOP',
	PLAY: 'PLAY',
	REMOVE: 'REMOVE'
};

},{}],2:[function(require,module,exports){
/** @jsx h */
const { h, patch } = require('../../lib');
const store = require('./store');
const constants = require('./constants');
var currentTree;
var counters = {};

// EVENTS
function onSubmit(e) {
  e.preventDefault();
  const title = e.target.childNodes[0].value;
  const seconds = e.target.childNodes[1].value;
  if (title && seconds) {
    e.target.childNodes[0].focus();
    e.target.childNodes[0].value = '';
    e.target.childNodes[1].value = '';
    store.dispatch(constants.ADD_CARD, { title, seconds });
  }
  return false;
}

function onAddTask(e, id) {
  const { value } = e.target;
  if (e.keyCode === 13 && value) {
    store.dispatch(constants.ADD_TASK, { id, value });
    e.target.value = '';
  }
}

function onTaskToggle(id, idx) {
  store.dispatch(constants.TASK_TOGGLE, { id, idx });
}

function onRemoveTask(id, idx) {
  store.dispatch(constants.REMOVE_TASK, { id, idx });
}

function onStop(e, id) {
  e.stopPropagation();
  store.dispatch(constants.STOP, { id });
}

function onStart(e, id) {
  e.stopPropagation();
  store.dispatch(constants.PLAY, { id });
}

function onRemove(e, id) {
  e.stopPropagation();
  clearTimes(id);
  store.dispatch(constants.REMOVE, { id });
}

function clearTimes(id) {
  if (!counters[id]) {
    return;
  }
  counters[id].map(c => clearInterval(c));
  counters[id] = [];
}
function times(id, seconds, stop) {
  if (!counters[id] || counters[id].length === 0) {
    const fn = function (s, i) {
      return () => store.dispatch(constants.COUNTING, { id: i, seconds: s-- });
    }(seconds, id);
    counters[id] = counters[id] || [];
    counters[id].push(setInterval(fn, 1000));
    return;
  }

  if (stop || seconds === 0) {
    clearTimes(id);
    if (seconds === 0) {
      setTimeout(() => store.dispatch(constants.REMOVE, { id }), 1);
    }
  }
}

// ELEMENTS
function Header(props) {
  return h(
    'header',
    { className: 'header' },
    h(
      'form',
      { onsubmit: onSubmit },
      h('input', { type: 'text', placeholder: 'title' }),
      h('input', { type: 'number', placeholder: 'timeout' }),
      h('input', { type: 'submit', style: { display: 'none' } })
    )
  );
}

function Actions(props) {
  const { id } = props;
  return h(
    'div',
    { className: 'card__actions' },
    h(
      'span',
      { className: 'play', onclick: e => onStart(e, id) },
      'Play'
    ),
    h(
      'span',
      { className: 'stop', onclick: e => onStop(e, id) },
      'Stop'
    ),
    h(
      'span',
      { className: 'remove', onclick: e => onRemove(e, id) },
      'Rem'
    )
  );
};

function AddTask(props) {
  const { id } = props;
  return h(
    'div',
    { className: 'card__input' },
    h('input', { type: 'text', onkeyup: e => onAddTask(e, id) })
  );
};

function Tasks(props) {
  const { id, tasks } = props;
  return h(
    'ul',
    { className: 'tasks' },
    tasks.map((item, idx) => h(
      'li',
      { className: item.done ? 'done' : '' },
      h(
        'span',
        { onclick: () => onTaskToggle(id, idx) },
        item.task
      ),
      h(
        'small',
        { onclick: () => onRemoveTask(id, idx), className: 'del' },
        '\xD7'
      )
    ))
  );
};

function Time(props) {
  const { seconds } = props.card;
  return h(
    'div',
    { className: 'timeout' },
    h(
      'h5',
      null,
      seconds,
      ' ',
      h(
        'small',
        null,
        'sec'
      )
    )
  );
};

function Progress(props) {
  const { tasks } = props;
  const total = tasks.length;
  const done = tasks.filter(t => t.done).length || 0;
  const left = 100 / total * done;
  const className = left < 30 ? 'low' : left < 50 ? 'half' : left < 100 ? 'high' : left === 100 ? 'ok' : '';
  return h(
    'div',
    { className: `progress ${className}` },
    h('span', { style: { left: `${left}%` } })
  );
};

function Card(props) {
  const { card } = props;
  const { id, title, seconds, tasks, stop } = card;
  times(id, seconds, stop || seconds === 0);
  return h(
    'li',
    null,
    h(
      'div',
      { className: 'card' },
      h(
        'h1',
        null,
        title
      ),
      h(AddTask, { id: id }),
      h(Tasks, { tasks: tasks, id: id }),
      h(Progress, { tasks: tasks }),
      h(Time, { card: card }),
      h(Actions, { id: id })
    )
  );
}

function Cards(props) {
  return h(
    'div',
    { className: 'limiter' },
    h(
      'ul',
      { className: 'cards' },
      props.datas.map(card => h(Card, { card: card }))
    )
  );
}
function App(props) {
  const { datas } = props;
  return h(
    'div',
    null,
    h(Header, null),
    h(Cards, { datas: datas })
  );
}

function render(datas) {
  const nextTree = h(App, { datas: datas });
  patch(document.getElementById('app'), nextTree, currentTree);
  currentTree = nextTree;
}
store.subscribe(render);
store.dispatch('INI');

},{"../../lib":5,"./constants":1,"./store":3}],3:[function(require,module,exports){
const constants = require('./constants');

const getId = (() => {
	var id = 1;
	return () => id++;
})();

const initialState = [{
	id: getId(),
	title: 'Some thing to do',
	tasks: [{ task: 'one', done: false }, { task: 'two', done: false }],
	seconds: 60,
	stop: false
}];

const store = (initialState => {
	var listeners = [];
	var currentState = initialState;

	function subscribe(fn) {
		listeners.push(fn);
	}

	function dispatch(action, payload) {
		console.log(action, payload);
		switch (action) {
			case constants.ADD_CARD:
				{
					const { title, seconds } = payload;
					const newCard = {
						id: getId(),
						title,
						seconds,
						tasks: [],
						stop: false
					};
					currentState = [newCard, ...currentState];
					break;
				}
			case constants.ADD_TASK:
				{
					currentState = [...currentState].map(card => {
						if (payload.id === card.id) {
							card.tasks = [{ task: payload.value, done: false }, ...card.tasks];
						}
						return card;
					});
					break;
				}
			case constants.TASK_TOGGLE:
				{
					currentState = [...currentState].map(card => {
						if (payload.id === card.id) {
							card.tasks = [...card.tasks].map((task, idx) => {
								if (payload.idx === idx) {
									task.done = !task.done;
								}
								return task;
							});
						}
						return card;
					});
					break;
				}
			case constants.REMOVE_TASK:
				{
					currentState = [...currentState].map(card => {
						if (payload.id === card.id) {
							card.tasks = [...card.tasks].filter((task, idx) => idx !== payload.idx);
						}
						return card;
					});
					break;
				}

			case constants.COUNTING:
				{
					currentState = [...currentState].map(card => {
						if (payload.id === card.id) {
							card.seconds = payload.seconds;
						}
						return card;
					});
					break;
				}

			case constants.STOP:
				{
					currentState = [...currentState].map(card => {
						if (payload.id === card.id) {
							card.stop = true;
						}
						return card;
					});
					break;
				}

			case constants.PLAY:
				{
					currentState = [...currentState].map(card => {
						if (payload.id === card.id) {
							card.stop = false;
						}
						return card;
					});
					break;
				}
			case constants.REMOVE:
				{
					currentState = [...currentState].filter(card => payload.id !== card.id);
					break;
				}
		}

		listeners.forEach(fn => fn(getState()));
	}

	function getState() {
		return [...currentState];
	}

	return {
		subscribe,
		dispatch,
		getState
	};
})(initialState);

module.exports = store;

},{"./constants":1}],4:[function(require,module,exports){
function isObject(x) {
  return typeof x === "object" && x !== null;
}

function isFunction(x) {
  return typeof x === "function";
}

function isString(x) {
  return typeof x === "string";
}

function isUndefined(x) {
  return x === undefined;
}

const isArray = Array.isArray || function (obj) {
  return Object.prototype.toString.call(obj) === "[object Array]";
};

function head(x) {
  return isString(x) ? x.charAt(0) : x[0];
}

function merge(a, b) {
  return Object.assign({}, a, b);
}

module.exports = {
  isObject,
  isFunction,
  isArray,
  isString,
  isUndefined,
  head,
  merge
};

},{}],5:[function(require,module,exports){
const {
  isArray,
  isObject,
  isFunction,
  isUndefined,
  head,
  merge
} = require('./helpers');

function h(type, props, ...children) {
  if (isFunction(type)) {
    return type(props);
  }
  if (isArray(head(children))) {
    children = head(children);
  }
  return { type, props: props || {}, children };
}

function createElement(node) {
  if (!isObject(node)) {
    return document.createTextNode(String(node));
  }
  const $el = document.createElement(node.type);
  applyProps($el, node.props);
  node.children.map(child => $el.appendChild(createElement(child)));
  return $el;
}

function patch($parent, newTree, oldTree, index = 0) {
  if (!oldTree) {
    $parent.appendChild(createElement(newTree));
  }if (!newTree) {
    removeChildren($parent, index);
  } else if (changed(newTree, oldTree)) {
    $parent.replaceChild(createElement(newTree), $parent.childNodes[index]);
  } else if (!isUndefined(newTree.type)) {
    applyProps($parent.childNodes[index], newTree.props, oldTree.props);
    patchNodes($parent, newTree, oldTree, index);
  }
}

function changed(a, b) {
  return typeof a !== typeof b || !isObject(a) && a !== b || a.type !== b.type;
}

function patchNodes($parent, newTree, oldTree, index) {
  const len = Math.max(newTree.children.length, oldTree.children.length);
  let i = -1;
  while (++i < len) {
    patch($parent.childNodes[index], newTree.children[i], oldTree.children[i], i);
  }
}

function removeChildren($parent, index) {
  let times = ($parent.childNodes.length || 0) - index;
  while (times-- > 0) {
    if ($parent.lastChild) {
      $parent.removeChild($parent.lastChild);
    }
  }
}

function applyProps($el, newProps, oldProps = {}) {
  const props = merge(newProps, oldProps);
  Object.keys(props).map(name => {
    const newValue = newProps[name];
    const oldValue = oldProps[name];
    if (isObject(newValue)) {
      applyProps($el[name], newValue, oldValue);
    } else {
      if (!newValue) {
        removeProp($el, name);
      } else if (newValue !== oldValue) {
        setProp($el, name, newValue);
      }
    }
  });
}

function setProp($el, name, value) {
  if (name === 'className') {
    $el.setAttribute('class', value);
  } else {
    $el[name] = value;
  }
}

function removeProp($el, name) {
  if (name === 'className') {
    $el.removeAttribute('class');
  } else {
    $el[name] = null;
    delete $el[name];
  }
}

module.exports = {
  h,
  patch
};

},{"./helpers":4}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJleGFtcGxlcy9jYXJkcy9jb25zdGFudHMuanMiLCJleGFtcGxlcy9jYXJkcy9pbmRleC5qcyIsImV4YW1wbGVzL2NhcmRzL3N0b3JlLmpzIiwibGliL2hlbHBlcnMuanMiLCJsaWIvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxPQUFPLE9BQVAsR0FBaUI7QUFDaEIsV0FBVSxVQURNO0FBRWhCLFdBQVUsVUFGTTtBQUdoQixjQUFhLGFBSEc7QUFJaEIsY0FBYSxhQUpHO0FBS2hCLFdBQVUsVUFMTTtBQU1oQixPQUFNLE1BTlU7QUFPaEIsT0FBTSxNQVBVO0FBUWhCLFNBQVE7QUFSUSxDQUFqQjs7O0FDQUE7QUFDQSxNQUFNLEVBQUUsQ0FBRixFQUFLLEtBQUwsS0FBZSxRQUFRLFdBQVIsQ0FBckI7QUFDQSxNQUFNLFFBQVEsUUFBUSxTQUFSLENBQWQ7QUFDQSxNQUFNLFlBQVksUUFBUSxhQUFSLENBQWxCO0FBQ0EsSUFBSSxXQUFKO0FBQ0EsSUFBSSxXQUFXLEVBQWY7O0FBRUE7QUFDQSxTQUFTLFFBQVQsQ0FBa0IsQ0FBbEIsRUFBcUI7QUFDbkIsSUFBRSxjQUFGO0FBQ0EsUUFBTSxRQUFRLEVBQUUsTUFBRixDQUFTLFVBQVQsQ0FBb0IsQ0FBcEIsRUFBdUIsS0FBckM7QUFDQSxRQUFNLFVBQVUsRUFBRSxNQUFGLENBQVMsVUFBVCxDQUFvQixDQUFwQixFQUF1QixLQUF2QztBQUNBLE1BQUksU0FBUyxPQUFiLEVBQXNCO0FBQ3BCLE1BQUUsTUFBRixDQUFTLFVBQVQsQ0FBb0IsQ0FBcEIsRUFBdUIsS0FBdkI7QUFDQSxNQUFFLE1BQUYsQ0FBUyxVQUFULENBQW9CLENBQXBCLEVBQXVCLEtBQXZCLEdBQStCLEVBQS9CO0FBQ0EsTUFBRSxNQUFGLENBQVMsVUFBVCxDQUFvQixDQUFwQixFQUF1QixLQUF2QixHQUErQixFQUEvQjtBQUNBLFVBQU0sUUFB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QSxRQUFJLFNBQVMsUUFBVCxDQUFKLEVBQXdCO0FBQ3RCLGlCQUFXLElBQUksSUFBSixDQUFYLEVBQXNCLFFBQXRCLEVBQWdDLFFBQWhDO0FBQ0QsS0FGRCxNQUVPO0FBQ0wsVUFBSSxDQUFDLFFBQUwsRUFBZTtBQUNiLG1CQUFXLEdBQVgsRUFBZ0IsSUFBaEI7QUFDRCxPQUZELE1BRU8sSUFBSSxhQUFhLFFBQWpCLEVBQTJCO0FBQ2hDLGdCQUFRLEdBQVIsRUFBYSxJQUFiLEVBQW1CLFFBQW5CO0FBQ0Q7QUFDRjtBQUNGLEdBWkQ7QUFhRDs7QUFFRCxTQUFTLE9BQVQsQ0FBaUIsR0FBakIsRUFBc0IsSUFBdEIsRUFBNEIsS0FBNUIsRUFBbUM7QUFDakMsTUFBSSxTQUFTLFdBQWIsRUFBMEI7QUFDeEIsUUFBSSxZQUFKLENBQWlCLE9BQWpCLEVBQTBCLEtBQTFCO0FBQ0QsR0FGRCxNQUVPO0FBQ0wsUUFBSSxJQUFKLElBQVksS0FBWjtBQUNEO0FBQ0Y7O0FBRUQsU0FBUyxVQUFULENBQW9CLEdBQXBCLEVBQXlCLElBQXpCLEVBQStCO0FBQzdCLE1BQUksU0FBUyxXQUFiLEVBQTBCO0FBQ3hCLFFBQUksZUFBSixDQUFvQixPQUFwQjtBQUNELEdBRkQsTUFFTztBQUNMLFFBQUksSUFBSixJQUFZLElBQVo7QUFDQSxXQUFPLElBQUksSUFBSixDQUFQO0FBQ0Q7QUFDRjs7QUFFRCxPQUFPLE9BQVAsR0FBaUI7QUFDZixHQURlO0FBRWY7QUFGZSxDQUFqQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJtb2R1bGUuZXhwb3J0cyA9IHtcblx0QUREX0NBUkQ6ICdBRERfQ0FSRCcsXG5cdEFERF9UQVNLOiAnQUREX1RBU0snLFxuXHRUQVNLX1RPR0dMRTogJ1RBU0tfVE9HR0xFJyxcblx0UkVNT1ZFX1RBU0s6ICdSRU1PVkVfVEFTSycsXG5cdENPVU5USU5HOiAnQ09VTlRJTkcnLFxuXHRTVE9QOiAnU1RPUCcsXG5cdFBMQVk6ICdQTEFZJyxcblx0UkVNT1ZFOiAnUkVNT1ZFJyxcbn07IiwiLyoqIEBqc3ggaCAqL1xuY29uc3QgeyBoLCBwYXRjaCB9ID0gcmVxdWlyZSgnLi4vLi4vbGliJyk7XG5jb25zdCBzdG9yZSA9IHJlcXVpcmUoJy4vc3RvcmUnKTtcbmNvbnN0IGNvbnN0YW50cyA9IHJlcXVpcmUoJy4vY29uc3RhbnRzJyk7XG52YXIgY3VycmVudFRyZWU7XG52YXIgY291bnRlcnMgPSB7fTtcblxuLy8gRVZFTlRTXG5mdW5jdGlvbiBvblN1Ym1pdChlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgdGl0bGUgPSBlLnRhcmdldC5jaGlsZE5vZGVzWzBdLnZhbHVlO1xuICBjb25zdCBzZWNvbmRzID0gZS50YXJnZXQuY2hpbGROb2Rlc1sxXS52YWx1ZTtcbiAgaWYgKHRpdGxlICYmIHNlY29uZHMpIHtcbiAgICBlLnRhcmdldC5jaGlsZE5vZGVzWzBdLmZvY3VzKCk7XG4gICAgZS50YXJnZXQuY2hpbGROb2Rlc1swXS52YWx1ZSA9ICcnO1xuICAgIGUudGFyZ2V0LmNoaWxkTm9kZXNbMV0udmFsdWUgPSAnJztcbiAgICBzdG9yZS5kaXNwYXRjaChjb25zdGFudHMuQUREX0NBUkQsIHsgdGl0bGUsIHNlY29uZHMgfSk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBvbkFkZFRhc2soZSwgaWQpIHtcbiAgY29uc3QgeyB2YWx1ZSB9ID0gZS50YXJnZXQ7XG4gIGlmIChlLmtleUNvZGUgPT09IDEzICYmIHZhbHVlKSB7XG4gICAgc3RvcmUuZGlzcGF0Y2goY29uc3RhbnRzLkFERF9UQVNLLCB7IGlkLCB2YWx1ZSB9KTtcbiAgICBlLnRhcmdldC52YWx1ZSA9ICcnO1xuICB9XG59XG5cbmZ1bmN0aW9uIG9uVGFza1RvZ2dsZShpZCwgaWR4KSB7XG4gIHN0b3JlLmRpc3BhdGNoKGNvbnN0YW50cy5UQVNLX1RPR0dMRSwgeyBpZCwgaWR4IH0pO1xufVxuXG5mdW5jdGlvbiBvblJlbW92ZVRhc2soaWQsIGlkeCkge1xuICBzdG9yZS5kaXNwYXRjaChjb25zdGFudHMuUkVNT1ZFX1RBU0ssIHsgaWQsIGlkeCB9KTtcbn1cblxuZnVuY3Rpb24gb25TdG9wKGUsIGlkKSB7XG4gIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIHN0b3JlLmRpc3BhdGNoKGNvbnN0YW50cy5TVE9QLCB7IGlkIH0pO1xufVxuXG5mdW5jdGlvbiBvblN0YXJ0KGUsIGlkKSB7XG4gIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIHN0b3JlLmRpc3BhdGNoKGNvbnN0YW50cy5QTEFZLCB7IGlkIH0pO1xufVxuXG5mdW5jdGlvbiBvblJlbW92ZShlLCBpZCkge1xuICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICBjbGVhclRpbWVzKGlkKTtcbiAgc3RvcmUuZGlzcGF0Y2goY29uc3RhbnRzLlJFTU9WRSwgeyBpZCB9KTtcbn1cblxuZnVuY3Rpb24gY2xlYXJUaW1lcyhpZCkge1xuICBpZiAoIWNvdW50ZXJzW2lkXSkge1xuICAgIHJldHVybiA7XG4gIH1cbiAgY291bnRlcnNbaWRdLm1hcChjID0+IGNsZWFySW50ZXJ2YWwoYykpO1xuICBjb3VudGVyc1tpZF0gPSBbXTtcbn1cbmZ1bmN0aW9uIHRpbWVzKGlkLCBzZWNvbmRzLCBzdG9wKSB7XG4gIGlmICghY291bnRlcnNbaWRdIHx8IGNvdW50ZXJzW2lkXS5sZW5ndGggPT09IDApIHtcbiAgICBjb25zdCBmbiA9IChmdW5jdGlvbihzLCBpKSB7XG4gICAgICByZXR1cm4gKCkgPT4gc3RvcmUuZGlzcGF0Y2goY29uc3RhbnRzLkNPVU5USU5HLCB7IGlkOiBpLCBzZWNvbmRzOiBzLS0gfSk7XG4gICAgfSkoc2Vjb25kcywgaWQpO1xuICAgIGNvdW50ZXJzW2lkXSA9IGNvdW50ZXJzW2lkXSB8fCBbXTtcbiAgICBjb3VudGVyc1tpZF0ucHVzaChzZXRJbnRlcnZhbChmbiwgMTAwMCkpO1xuICAgIHJldHVybjtcbiAgfSBcblxuICBpZiAoc3RvcCB8fCBzZWNvbmRzID09PSAwKSB7XG4gICAgY2xlYXJUaW1lcyhpZCk7XG4gICAgaWYgKHNlY29uZHMgPT09IDApIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gc3RvcmUuZGlzcGF0Y2goY29uc3RhbnRzLlJFTU9WRSwgeyBpZCB9KSwgMSk7XG4gICAgfVxuICB9XG59XG5cblxuLy8gRUxFTUVOVFNcbmZ1bmN0aW9uIEhlYWRlcihwcm9wcykge1xuICByZXR1cm4gKFxuICAgIDxoZWFkZXIgY2xhc3NOYW1lPVwiaGVhZGVyXCI+XG4gICAgICA8Zm9ybSBvbnN1Ym1pdD17b25TdWJtaXR9PlxuICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cInRpdGxlXCIvPlxuICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIHBsYWNlaG9sZGVyPVwidGltZW91dFwiIC8+XG4gICAgICAgIDxpbnB1dCB0eXBlPVwic3VibWl0XCIgc3R5bGU9e3sgZGlzcGxheTogJ25vbmUnIH19IC8+XG4gICAgICA8L2Zvcm0+XG4gICAgPC9oZWFkZXI+XG4gICk7XG59XG5cbmZ1bmN0aW9uIEFjdGlvbnMocHJvcHMpIHtcbiAgY29uc3QgeyBpZCB9ID0gcHJvcHM7XG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkX19hY3Rpb25zXCI+XG4gICAgICA8c3BhbiBjbGFzc05hbWU9XCJwbGF5XCIgb25jbGljaz17ZSA9PiBvblN0YXJ0KGUsIGlkKX0+UGxheTwvc3Bhbj5cbiAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInN0b3BcIiBvbmNsaWNrPXtlID0+IG9uU3RvcChlLCBpZCl9PlN0b3A8L3NwYW4+XG4gICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZW1vdmVcIiBvbmNsaWNrPXtlID0+IG9uUmVtb3ZlKGUsIGlkKX0+UmVtPC9zcGFuPlxuICAgIDwvZGl2PlxuICApO1xufTtcblxuZnVuY3Rpb24gQWRkVGFzayhwcm9wcykge1xuICBjb25zdCB7IGlkIH0gPSBwcm9wcztcbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcmRfX2lucHV0XCI+XG4gICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBvbmtleXVwPXsoZSkgPT4gb25BZGRUYXNrKGUsIGlkKX0gLz5cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5cbmZ1bmN0aW9uIFRhc2tzKHByb3BzKSB7XG4gIGNvbnN0IHsgaWQsIHRhc2tzIH0gPSBwcm9wcztcbiAgcmV0dXJuIChcbiAgICA8dWwgY2xhc3NOYW1lPVwidGFza3NcIj5cbiAgICAgIHt0YXNrcy5tYXAoKGl0ZW0sIGlkeCkgPT4gKFxuICAgICAgICA8bGkgY2xhc3NOYW1lPXsgaXRlbS5kb25lID8gJ2RvbmUnIDogJycgfT5cbiAgICAgICAgICA8c3BhbiBvbmNsaWNrPXsoKSA9PiBvblRhc2tUb2dnbGUoaWQsIGlkeCl9PntpdGVtLnRhc2t9PC9zcGFuPiBcbiAgICAgICAgICA8c21hbGwgb25jbGljaz17KCkgPT4gb25SZW1vdmVUYXNrKGlkLCBpZHgpfSBjbGFzc05hbWU9XCJkZWxcIj4mdGltZXM7PC9zbWFsbD5cbiAgICAgICAgPC9saT5cbiAgICAgICkpfVxuICAgIDwvdWw+XG4gICk7XG59O1xuXG5mdW5jdGlvbiBUaW1lKHByb3BzKSB7XG4gIGNvbnN0IHsgc2Vjb25kcyB9ID0gcHJvcHMuY2FyZDtcbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cInRpbWVvdXRcIj5cbiAgICAgIDxoNT57c2Vjb25kc30gPHNtYWxsPnNlYzwvc21hbGw+PC9oNT5cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5cbmZ1bmN0aW9uIFByb2dyZXNzKHByb3BzKSB7XG4gIGNvbnN0IHsgdGFza3MgfSA9IHByb3BzO1xuICBjb25zdCB0b3RhbCA9IHRhc2tzLmxlbmd0aDtcbiAgY29uc3QgZG9uZSA9IHRhc2tzLmZpbHRlcih0ID0+IHQuZG9uZSkubGVuZ3RoIHx8IDA7XG4gIGNvbnN0IGxlZnQgPSAoMTAwIC8gdG90YWwpICogZG9uZTtcbiAgY29uc3QgY2xhc3NOYW1lID0gbGVmdCA8IDMwID8gJ2xvdycgOiAobGVmdCA8IDUwKSA/ICdoYWxmJyA6IChsZWZ0IDwgMTAwID8gJ2hpZ2gnIDogbGVmdCA9PT0gMTAwID8gJ29rJyA6ICcnKTtcbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT17YHByb2dyZXNzICR7Y2xhc3NOYW1lfWB9PlxuICAgICAgPHNwYW4gc3R5bGU9e3sgbGVmdDogYCR7bGVmdH0lYCB9fT48L3NwYW4+XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5mdW5jdGlvbiBDYXJkKHByb3BzKSB7XG4gIGNvbnN0IHsgY2FyZCB9ID0gcHJvcHM7XG4gIGNvbnN0IHsgaWQsIHRpdGxlLCBzZWNvbmRzLCB0YXNrcywgc3RvcCB9ID0gY2FyZDtcbiAgdGltZXMoaWQsIHNlY29uZHMsIChzdG9wIHx8IHNlY29uZHMgPT09IDApKTtcbiAgcmV0dXJuIChcbiAgICA8bGk+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcmRcIj5cbiAgICAgICAgPGgxPnt0aXRsZX08L2gxPlxuICAgICAgICA8QWRkVGFzayBpZD17aWR9IC8+XG4gICAgICAgIDxUYXNrcyB0YXNrcz17dGFza3N9IGlkPXtpZH0gLz5cbiAgICAgICAgPFByb2dyZXNzIHRhc2tzPXt0YXNrc30gLz5cbiAgICAgICAgPFRpbWUgY2FyZD17Y2FyZH0gLz5cbiAgICAgICAgPEFjdGlvbnMgaWQ9e2lkfSAvPlxuICAgICAgPC9kaXY+XG4gICAgPC9saT5cbiAgKTtcbn1cblxuZnVuY3Rpb24gQ2FyZHMocHJvcHMpIHtcbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImxpbWl0ZXJcIj5cbiAgICAgIDx1bCBjbGFzc05hbWU9XCJjYXJkc1wiPlxuICAgICAgICB7cHJvcHMuZGF0YXMubWFwKGNhcmQgPT4gPENhcmQgY2FyZD17Y2FyZH0gLz4pfVxuICAgICAgPC91bD5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbmZ1bmN0aW9uIEFwcChwcm9wcykge1xuICBjb25zdCB7IGRhdGFzIH0gPSBwcm9wcztcbiAgcmV0dXJuIChcbiAgICA8ZGl2PlxuICAgICAgPEhlYWRlciAvPlxuICAgICAgPENhcmRzIGRhdGFzPXtkYXRhc30gLz5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyKGRhdGFzKSB7XG4gIGNvbnN0IG5leHRUcmVlID0gPEFwcCBkYXRhcz17ZGF0YXN9IC8+O1xuICBwYXRjaChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwJyksIG5leHRUcmVlLCBjdXJyZW50VHJlZSk7XG4gIGN1cnJlbnRUcmVlID0gbmV4dFRyZWU7XG59XG5zdG9yZS5zdWJzY3JpYmUocmVuZGVyKTtcbnN0b3JlLmRpc3BhdGNoKCdJTkknKTsiLCJjb25zdCBjb25zdGFudHMgPSByZXF1aXJlKCcuL2NvbnN0YW50cycpO1xuXG5jb25zdCBnZXRJZCA9ICgoKSA9PiB7XG5cdHZhciBpZCA9IDE7XG5cdHJldHVybiAoKSA9PiBpZCsrO1xufSkoKTtcblxuY29uc3QgaW5pdGlhbFN0YXRlID0gW1xuICB7XG5cdFx0aWQ6IGdldElkKCksXG4gICAgdGl0bGU6ICdTb21lIHRoaW5nIHRvIGRvJyxcbiAgICB0YXNrczogW3sgdGFzazogJ29uZScsIGRvbmU6IGZhbHNlfSAsIHsgdGFzazogJ3R3bycsIGRvbmU6IGZhbHNlIH1dLFxuICAgIHNlY29uZHM6IDYwLFxuXHRcdHN0b3A6IGZhbHNlXG4gIH1cbl07XG5cbmNvbnN0IHN0b3JlID0gKChpbml0aWFsU3RhdGUpID0+IHtcbiAgdmFyIGxpc3RlbmVycyA9IFtdO1xuICB2YXIgY3VycmVudFN0YXRlID0gaW5pdGlhbFN0YXRlO1xuXG4gIGZ1bmN0aW9uIHN1YnNjcmliZShmbikge1xuICAgIGxpc3RlbmVycy5wdXNoKGZuKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRpc3BhdGNoKGFjdGlvbiwgcGF5bG9hZCkgeyBcblx0XHRjb25zb2xlLmxvZyhhY3Rpb24sIHBheWxvYWQpO1xuXHRcdHN3aXRjaChhY3Rpb24pIHtcblx0XHRcdGNhc2UgY29uc3RhbnRzLkFERF9DQVJEOiB7XG5cdFx0XHRcdGNvbnN0IHsgdGl0bGUsIHNlY29uZHMgfSA9IHBheWxvYWQ7XG5cdFx0XHRcdGNvbnN0IG5ld0NhcmQgPSB7XG5cdFx0XHRcdFx0aWQ6IGdldElkKCksXG5cdFx0XHRcdFx0dGl0bGUsXG5cdFx0XHRcdFx0c2Vjb25kcyxcblx0XHRcdFx0XHR0YXNrczogW10sXG5cdFx0XHRcdFx0c3RvcDogZmFsc2Vcblx0XHRcdFx0fTtcblx0XHRcdFx0Y3VycmVudFN0YXRlID0gW25ld0NhcmQsIC4uLmN1cnJlbnRTdGF0ZV07XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0Y2FzZSBjb25zdGFudHMuQUREX1RBU0s6IHtcblx0XHRcdFx0Y3VycmVudFN0YXRlID0gWy4uLmN1cnJlbnRTdGF0ZV0ubWFwKGNhcmQgPT4ge1xuXHRcdFx0XHRcdGlmIChwYXlsb2FkLmlkID09PSBjYXJkLmlkKSB7XG5cdFx0XHRcdFx0XHRjYXJkLnRhc2tzID0gW3sgdGFzazogcGF5bG9hZC52YWx1ZSwgZG9uZTogZmFsc2UgfSwgLi4uY2FyZC50YXNrc107XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBjYXJkO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRjYXNlIGNvbnN0YW50cy5UQVNLX1RPR0dMRToge1xuXHRcdFx0XHRjdXJyZW50U3RhdGUgPSBbLi4uY3VycmVudFN0YXRlXS5tYXAoY2FyZCA9PiB7XG5cdFx0XHRcdFx0aWYgKHBheWxvYWQuaWQgPT09IGNhcmQuaWQpIHtcblx0XHRcdFx0XHRcdGNhcmQudGFza3MgPSBbLi4uY2FyZC50YXNrc10ubWFwKCh0YXNrLCBpZHgpID0+IHtcblx0XHRcdFx0XHRcdFx0aWYgKHBheWxvYWQuaWR4ID09PSBpZHgpIHtcblx0XHRcdFx0XHRcdFx0XHR0YXNrLmRvbmUgPSAhdGFzay5kb25lO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0YXNrO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBjYXJkO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRjYXNlIGNvbnN0YW50cy5SRU1PVkVfVEFTSzoge1xuXHRcdFx0XHRjdXJyZW50U3RhdGUgPSBbLi4uY3VycmVudFN0YXRlXS5tYXAoY2FyZCA9PiB7XG5cdFx0XHRcdFx0aWYgKHBheWxvYWQuaWQgPT09IGNhcmQuaWQpIHtcblx0XHRcdFx0XHRcdGNhcmQudGFza3MgPSBbLi4uY2FyZC50YXNrc10uZmlsdGVyKCh0YXNrLCBpZHgpID0+IGlkeCAhPT0gcGF5bG9hZC5pZHgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gY2FyZDtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXG5cdFx0XHRjYXNlIGNvbnN0YW50cy5DT1VOVElORzoge1xuXHRcdFx0XHRjdXJyZW50U3RhdGUgPSBbLi4uY3VycmVudFN0YXRlXS5tYXAoY2FyZCA9PiB7XG5cdFx0XHRcdFx0aWYgKHBheWxvYWQuaWQgPT09IGNhcmQuaWQpIHtcblx0XHRcdFx0XHRcdGNhcmQuc2Vjb25kcyA9IHBheWxvYWQuc2Vjb25kcztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIGNhcmQ7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblxuXHRcdFx0Y2FzZSBjb25zdGFudHMuU1RPUDoge1xuXHRcdFx0XHRjdXJyZW50U3RhdGUgPSBbLi4uY3VycmVudFN0YXRlXS5tYXAoY2FyZCA9PiB7XG5cdFx0XHRcdFx0aWYgKHBheWxvYWQuaWQgPT09IGNhcmQuaWQpIHtcblx0XHRcdFx0XHRcdGNhcmQuc3RvcCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBjYXJkO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cblx0XHRcdGNhc2UgY29uc3RhbnRzLlBMQVk6IHtcblx0XHRcdFx0Y3VycmVudFN0YXRlID0gWy4uLmN1cnJlbnRTdGF0ZV0ubWFwKGNhcmQgPT4ge1xuXHRcdFx0XHRcdGlmIChwYXlsb2FkLmlkID09PSBjYXJkLmlkKSB7XG5cdFx0XHRcdFx0XHRjYXJkLnN0b3AgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIGNhcmQ7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGNhc2UgY29uc3RhbnRzLlJFTU9WRToge1xuXHRcdFx0XHRjdXJyZW50U3RhdGUgPSBbLi4uY3VycmVudFN0YXRlXS5maWx0ZXIoY2FyZCA9PiBwYXlsb2FkLmlkICE9PSBjYXJkLmlkKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXG4gICAgbGlzdGVuZXJzLmZvckVhY2goZm4gPT4gZm4oZ2V0U3RhdGUoKSkpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U3RhdGUoKSB7XG4gICAgcmV0dXJuIFsuLi5jdXJyZW50U3RhdGVdO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBzdWJzY3JpYmUsXG4gICAgZGlzcGF0Y2gsXG5cdFx0Z2V0U3RhdGUsXG4gIH07XG59KShpbml0aWFsU3RhdGUpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHN0b3JlOyIsImZ1bmN0aW9uIGlzT2JqZWN0KHgpIHtcbiAgcmV0dXJuIHR5cGVvZiB4ID09PSBcIm9iamVjdFwiICYmIHggIT09IG51bGw7XG59XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oeCkge1xuICByZXR1cm4gdHlwZW9mIHggPT09IFwiZnVuY3Rpb25cIjtcbn1cblxuZnVuY3Rpb24gaXNTdHJpbmcoeCkge1xuICByZXR1cm4gdHlwZW9mIHggPT09IFwic3RyaW5nXCI7XG59XG5cbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKHgpIHtcbiAgcmV0dXJuIHggPT09IHVuZGVmaW5lZDtcbn1cblxuY29uc3QgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24ob2JqKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gXCJbb2JqZWN0IEFycmF5XVwiO1xufVxuXG5mdW5jdGlvbiBoZWFkKHgpIHtcbiAgcmV0dXJuIGlzU3RyaW5nKHgpID8geC5jaGFyQXQoMCkgOiB4WzBdO1xufVxuXG5mdW5jdGlvbiBtZXJnZShhLCBiKSB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBhLCBiKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGlzT2JqZWN0LFxuICBpc0Z1bmN0aW9uLFxuICBpc0FycmF5LFxuICBpc1N0cmluZyxcbiAgaXNVbmRlZmluZWQsXG4gIGhlYWQsXG4gIG1lcmdlLFxufSIsImNvbnN0IHtcbiAgaXNBcnJheSxcbiAgaXNPYmplY3QsXG4gIGlzRnVuY3Rpb24sXG4gIGlzVW5kZWZpbmVkLFxuICBoZWFkLFxuICBtZXJnZSxcbn0gPSByZXF1aXJlKCcuL2hlbHBlcnMnKTtcblxuZnVuY3Rpb24gaCh0eXBlLCBwcm9wcywgLi4uY2hpbGRyZW4pIHtcbiAgaWYgKGlzRnVuY3Rpb24odHlwZSkpIHtcbiAgICByZXR1cm4gdHlwZShwcm9wcyk7XG4gIH1cbiAgaWYgKGlzQXJyYXkoaGVhZChjaGlsZHJlbikpKSB7XG4gICAgY2hpbGRyZW4gPSBoZWFkKGNoaWxkcmVuKTtcbiAgfVxuICByZXR1cm4geyB0eXBlLCBwcm9wczogcHJvcHMgfHwge30sIGNoaWxkcmVuIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQobm9kZSkge1xuICBpZiAoIWlzT2JqZWN0KG5vZGUpKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFN0cmluZyhub2RlKSk7XG4gIH1cbiAgY29uc3QgJGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlLnR5cGUpO1xuICBhcHBseVByb3BzKCRlbCwgbm9kZS5wcm9wcyk7XG4gIG5vZGUuY2hpbGRyZW4ubWFwKGNoaWxkID0+ICRlbC5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KGNoaWxkKSkpO1xuICByZXR1cm4gJGVsO1xufVxuXG5mdW5jdGlvbiBwYXRjaCgkcGFyZW50LCBuZXdUcmVlLCBvbGRUcmVlLCBpbmRleCA9IDApIHtcbiAgaWYgKCFvbGRUcmVlKSB7XG4gICAgJHBhcmVudC5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KG5ld1RyZWUpKTtcbiAgfSBpZiAoIW5ld1RyZWUpIHtcbiAgICByZW1vdmVDaGlsZHJlbigkcGFyZW50LCBpbmRleCk7XG4gIH0gZWxzZSBpZiAoY2hhbmdlZChuZXdUcmVlLCBvbGRUcmVlKSkge1xuICAgICRwYXJlbnQucmVwbGFjZUNoaWxkKGNyZWF0ZUVsZW1lbnQobmV3VHJlZSksICRwYXJlbnQuY2hpbGROb2Rlc1tpbmRleF0pO1xuICB9IGVsc2UgaWYgKCFpc1VuZGVmaW5lZChuZXdUcmVlLnR5cGUpKSB7XG4gICAgYXBwbHlQcm9wcygkcGFyZW50LmNoaWxkTm9kZXNbaW5kZXhdLCBuZXdUcmVlLnByb3BzLCBvbGRUcmVlLnByb3BzKTtcbiAgICBwYXRjaE5vZGVzKCRwYXJlbnQsIG5ld1RyZWUsIG9sZFRyZWUsIGluZGV4KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjaGFuZ2VkKGEsIGIpIHtcbiAgcmV0dXJuICh0eXBlb2YgYSAhPT0gdHlwZW9mIGIpIHx8ICghaXNPYmplY3QoYSkgJiYgYSAhPT0gYikgfHwgKGEudHlwZSAhPT0gYi50eXBlKSA7XG59XG5cbmZ1bmN0aW9uIHBhdGNoTm9kZXMoJHBhcmVudCwgbmV3VHJlZSwgb2xkVHJlZSwgaW5kZXgpIHtcbiAgY29uc3QgbGVuID0gTWF0aC5tYXgobmV3VHJlZS5jaGlsZHJlbi5sZW5ndGgsIG9sZFRyZWUuY2hpbGRyZW4ubGVuZ3RoKTtcbiAgbGV0IGkgPSAtMTtcbiAgd2hpbGUgKCsraSA8IGxlbikge1xuICAgIHBhdGNoKFxuICAgICAgJHBhcmVudC5jaGlsZE5vZGVzW2luZGV4XSxcbiAgICAgIG5ld1RyZWUuY2hpbGRyZW5baV0sXG4gICAgICBvbGRUcmVlLmNoaWxkcmVuW2ldLFxuICAgICAgaVxuICAgICk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVtb3ZlQ2hpbGRyZW4oJHBhcmVudCwgaW5kZXgpIHtcbiAgbGV0IHRpbWVzID0gKCRwYXJlbnQuY2hpbGROb2Rlcy5sZW5ndGggfHwgMCkgLSBpbmRleDtcbiAgd2hpbGUgKHRpbWVzLS0gPiAwKSB7XG4gICAgaWYgKCRwYXJlbnQubGFzdENoaWxkKSB7XG4gICAgICAkcGFyZW50LnJlbW92ZUNoaWxkKCRwYXJlbnQubGFzdENoaWxkKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gYXBwbHlQcm9wcygkZWwsIG5ld1Byb3BzLCBvbGRQcm9wcyA9IHt9KSB7XG4gIGNvbnN0IHByb3BzID0gbWVyZ2UobmV3UHJvcHMsIG9sZFByb3BzKTtcbiAgT2JqZWN0LmtleXMocHJvcHMpLm1hcChuYW1lID0+IHtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IG5ld1Byb3BzW25hbWVdO1xuICAgIGNvbnN0IG9sZFZhbHVlID0gb2xkUHJvcHNbbmFtZV07XG4gICAgaWYgKGlzT2JqZWN0KG5ld1ZhbHVlKSkge1xuICAgICAgYXBwbHlQcm9wcygkZWxbbmFtZV0sIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghbmV3VmFsdWUpIHtcbiAgICAgICAgcmVtb3ZlUHJvcCgkZWwsIG5hbWUpO1xuICAgICAgfSBlbHNlIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUpIHtcbiAgICAgICAgc2V0UHJvcCgkZWwsIG5hbWUsIG5ld1ZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBzZXRQcm9wKCRlbCwgbmFtZSwgdmFsdWUpIHtcbiAgaWYgKG5hbWUgPT09ICdjbGFzc05hbWUnKSB7XG4gICAgJGVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB2YWx1ZSk7XG4gIH0gZWxzZSB7XG4gICAgJGVsW25hbWVdID0gdmFsdWU7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVtb3ZlUHJvcCgkZWwsIG5hbWUpIHtcbiAgaWYgKG5hbWUgPT09ICdjbGFzc05hbWUnKSB7XG4gICAgJGVsLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTtcbiAgfSBlbHNlIHtcbiAgICAkZWxbbmFtZV0gPSBudWxsO1xuICAgIGRlbGV0ZSAkZWxbbmFtZV07XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGgsXG4gIHBhdGNoLFxufTtcbiJdfQ==
